{"version":3,"sources":["js/web3code.js"],"names":["ethPrice","receivedAmount","web3","Web3","aggregatorV3InterfaceABI","addr","document","getElementById","innerText","priceFeed","eth","Contract","methods","getLatestPrice","call","then","price","console","log","events","Received","error","event","returnValues","amountToPay","withdrawFruit","getElementsByClassName","innerHTML"],"mappings":"AAAA,IAAIA,QAAJ;AACA,IAAIC,cAAc,GAAG,CAArB,EAEA;;AACA,IAAMC,IAAI,GAAG,IAAIC,IAAJ,CAAS,8DAAT,CAAb,EAEA;;AACA,IAAMC,wBAAwB,GAC9B,CACC;AACC,YAAU,EADX;AAEC,qBAAmB,YAFpB;AAGC,UAAQ;AAHT,CADD,EAMC;AACC,eAAa,KADd;AAEC,YAAU,CACT;AACC,eAAW,KADZ;AAEC,oBAAgB,SAFjB;AAGC,YAAQ,EAHT;AAIC,YAAQ;AAJT,GADS,EAOT;AACC,eAAW,KADZ;AAEC,oBAAgB,SAFjB;AAGC,YAAQ,EAHT;AAIC,YAAQ;AAJT,GAPS,CAFX;AAgBC,UAAQ,UAhBT;AAiBC,UAAQ;AAjBT,CAND,EAyBC;AACC,YAAU,EADX;AAEC,UAAQ,gBAFT;AAGC,aAAW,CACV;AACC,oBAAgB,QADjB;AAEC,YAAQ,EAFT;AAGC,YAAQ;AAHT,GADU,CAHZ;AAUC,qBAAmB,MAVpB;AAWC,UAAQ;AAXT,CAzBD,EAsCC;AACC,qBAAmB,SADpB;AAEC,UAAQ;AAFT,CAtCD,CADA,EA6CA;;AACA,IAAMC,IAAI,GAAG,4CAAb;AAEAC,QAAQ,CAACC,cAAT,CAAwB,SAAxB,EAAmCC,SAAnC,GAA+CH,IAA/C,EAEA;;AACA,IAAMI,SAAS,GAAG,IAAIP,IAAI,CAACQ,GAAL,CAASC,QAAb,CAAsBP,wBAAtB,EAAgDC,IAAhD,CAAlB,EACA;;AACAI,SAAS,CAACG,OAAV,CAAkBC,cAAlB,GAAmCC,IAAnC,GACKC,IADL,CACU,UAACC,KAAD,EAAW;AACb;AACAhB,EAAAA,QAAQ,GAAGgB,KAAK,GAAG,IAAnB;AACAC,EAAAA,OAAO,CAACC,GAAR,CAAY,kBAAZ,EAAgCF,KAAK,GAAG,IAAxC;AACH,CALL;AAOAP,SAAS,CAACU,MAAV,CAAiBC,QAAjB,CAA0B,UAACC,KAAD,EAAQC,KAAR,EAAkB;AACxC,MAAIA,KAAJ,EAAW;AACPrB,IAAAA,cAAc,GAAGqB,KAAK,CAACC,YAAN,CAAmB,CAAnB,CAAjB;AACAN,IAAAA,OAAO,CAACC,GAAR,CAAYjB,cAAZ;AACAgB,IAAAA,OAAO,CAACC,GAAR,CAAYM,WAAW,GAAG,IAA1B;;AACA,QAAIvB,cAAc,IAAIuB,WAAW,GAAG,IAApC,EAA0C;AACtCC,MAAAA,aAAa,CAAC,GAAD,CAAb;AACAnB,MAAAA,QAAQ,CAACoB,sBAAT,CAAgC,iBAAhC,EAAmD,CAAnD,EAAsDC,SAAtD;AAyBH,KA3BD,MA2BO;AACHrB,MAAAA,QAAQ,CAACoB,sBAAT,CAAgC,iBAAhC,EAAmD,CAAnD,EAAsDC,SAAtD;AAyBH;AAEJ;AACJ,CA7DD","file":"web3code.dd679a6c.js","sourceRoot":"../src","sourcesContent":["let ethPrice;\nlet receivedAmount = 0;\n\n// Change this to use your own infura ID\nconst web3 = new Web3(\"wss://kovan.infura.io/ws/v3/48d55356a0d24b91855f633e8cf4b197\");\n\n// AggregatorV3Interface ABI\nconst aggregatorV3InterfaceABI =\n[\n\t{\n\t\t\"inputs\": [],\n\t\t\"stateMutability\": \"nonpayable\",\n\t\t\"type\": \"constructor\"\n\t},\n\t{\n\t\t\"anonymous\": false,\n\t\t\"inputs\": [\n\t\t\t{\n\t\t\t\t\"indexed\": false,\n\t\t\t\t\"internalType\": \"address\",\n\t\t\t\t\"name\": \"\",\n\t\t\t\t\"type\": \"address\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"indexed\": false,\n\t\t\t\t\"internalType\": \"uint256\",\n\t\t\t\t\"name\": \"\",\n\t\t\t\t\"type\": \"uint256\"\n\t\t\t}\n\t\t],\n\t\t\"name\": \"Received\",\n\t\t\"type\": \"event\"\n\t},\n\t{\n\t\t\"inputs\": [],\n\t\t\"name\": \"getLatestPrice\",\n\t\t\"outputs\": [\n\t\t\t{\n\t\t\t\t\"internalType\": \"int256\",\n\t\t\t\t\"name\": \"\",\n\t\t\t\t\"type\": \"int256\"\n\t\t\t}\n\t\t],\n\t\t\"stateMutability\": \"view\",\n\t\t\"type\": \"function\"\n\t},\n\t{\n\t\t\"stateMutability\": \"payable\",\n\t\t\"type\": \"receive\"\n\t}\n]\n\n// Price Feed Address\nconst addr = \"0xC8f872aEe06663b900c067Dfd3D87813e6A4F72A\";\n\ndocument.getElementById(\"address\").innerText = addr;\n\n// Set up contract instance\nconst priceFeed = new web3.eth.Contract(aggregatorV3InterfaceABI, addr);\n//Make call to latestRoundData()\npriceFeed.methods.getLatestPrice().call()\n    .then((price) => {\n        // Do something with roundData\n        ethPrice = price / 1.e8;\n        console.log(\"Ethereum Price: \", price / 1.e8)\n    });\n\npriceFeed.events.Received((error, event) => {\n    if (event) {\n        receivedAmount = event.returnValues[1];\n        console.log(receivedAmount);\n        console.log(amountToPay * 1e18);\n        if (receivedAmount >= amountToPay * 1e18) {\n            withdrawFruit('H');\n            document.getElementsByClassName(\"modal-card-body\")[0].innerHTML = `\n            <center>\n            <div class=\"columns is-vcentered has-background-primary\">\n                <div class=\"column\">\n                    <strong class=\"has-text-black\">\n                    Payment Succeeded\n                    </strong>\n                    <br>\n                </div>\n            </div>\n            <div class=\"columns is-vcentered\">\n                <div class=\"column\">\n                    <figure class=\"image is-128x128\">\n                    <img src=\"assets/png/basket.png\" alt=\"\">\n                    </figure>\n                </div>\n            </div>\n            <div class=\"columns is-vcentered has-background-info-light\">\n                <div class=\"column\">\n                   <strong class=\"has-text-black\">You can now withdraw your purchase</strong> \n                </div>\n            </div>\n\n        </center>\n            `;\n        } else {\n            document.getElementsByClassName(\"modal-card-body\")[0].innerHTML = `\n            <center>\n            <div class=\"columns is-vcentered has-background-danger\">\n                <div class=\"column\">\n                    <strong class=\"has-text-black\">\n                    Failed to proceed: Insufficient funds sent\n                    </strong>\n                    <br>\n                </div>\n            </div>\n            <div class=\"columns is-vcentered\">\n                <div class=\"column\">\n                    <figure class=\"image is-128x128\">\n                    <img src=\"assets/png/cashier.png\" alt=\"\">\n                    </figure>\n                </div>\n            </div>\n            <div class=\"columns is-vcentered has-background-info-light\">\n                <div class=\"column\">\n                   <strong class=\"has-text-black\">Please remake your purchase</strong> \n                </div>\n            </div>\n    \n        </center>\n            `;\n        }\n\n    }\n});"]}